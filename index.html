<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ekka-Barber | صالون الحلاقة</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            text-align: center;
            color: #333;
        }
        .category-buttons, .booking-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .category-button, .time-slot, .employee-button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .category-button:hover, .time-slot:hover, .employee-button:hover {
            background-color: #45a049;
        }
        .services-list {
            display: none;
        }
        .service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .service-item.selected {
            background-color: #e0f7fa;
        }
        .service-item label {
            flex-grow: 1;
            margin-left: 10px;
        }
        #selected-services, #total-price {
            margin-top: 20px;
            font-weight: bold;
        }
        .booking-container > div {
            flex: 1;
            min-width: 200px;
        }
        .time-slot.selected, .employee-button.selected {
            background-color: #45a049;
        }
        form {
            display: flex;
            flex-direction: column;
        }
        input, button[type="submit"] {
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button[type="submit"] {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button[type="submit"]:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ekka-Barber | صالون الحلاقة</h1>
        <h2>حجز موعد | Book an Appointment</h2>
        
        <!-- Previous category buttons and service lists remain the same -->

        <div class="booking-container">
            <div>
                <h3>التاريخ | Date</h3>
                <input type="date" id="booking-date">
            </div>
            <div>
                <h3>الوقت | Time</h3>
                <div id="time-slot-container"></div>
            </div>
            <div>
                <h3>اختر الموظف | Select Employee</h3>
                <div id="employee-container"></div>
            </div>
        </div>

        <div id="selected-services">الخدمات المختارة | Selected Services: </div>
        <div id="total-price">السعر الإجمالي | Total Price: 0 SAR</div>

        <form id="bookingForm">
            <input type="text" id="name" name="name" placeholder="الاسم | Name" required>
            <input type="tel" id="phone" name="phone" placeholder="رقم الهاتف | Phone Number" required pattern="\d{10}">
            <input type="hidden" id="selected-date" name="selected-date">
            <input type="hidden" id="selected-time" name="selected-time">
            <input type="hidden" id="selected-employee" name="selected-employee">
            <button type="submit">إرسال الحجز | Send Booking</button>
        </form>
    </div>

    <script>
        // Previous JavaScript for services remains the same

        // Sample employee data (replace with your actual employee data)
        const employees = [
            { name: "Ahmed", workingHours: { start: 10, end: 18 } },
            { name: "Fatima", workingHours: { start: 12, end: 20 } },
            { name: "Mohammed", workingHours: { start: 9, end: 17 } }
        ];

        function generateTimeSlots() {
            const container = document.getElementById('time-slot-container');
            container.innerHTML = '';
            for (let hour = 10; hour < 22; hour++) {
                for (let minute = 0; minute < 60; minute += 10) {
                    const time = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    const button = document.createElement('button');
                    button.className = 'time-slot';
                    button.textContent = time;
                    button.onclick = () => selectTimeSlot(button, time);
                    container.appendChild(button);
                }
            }
        }

        function selectTimeSlot(button, time) {
            document.querySelectorAll('.time-slot').forEach(b => b.classList.remove('selected'));
            button.classList.add('selected');
            document.getElementById('selected-time').value = time;
            updateEmployeeList(time);
        }

        function updateEmployeeList(selectedTime) {
            const container = document.getElementById('employee-container');
            container.innerHTML = '';
            const [hours, minutes] = selectedTime.split(':').map(Number);
            const selectedDateTime = new Date(2000, 0, 1, hours, minutes); // Arbitrary date, we only care about time

            employees.forEach(employee => {
                const startTime = new Date(2000, 0, 1, employee.workingHours.start, 0);
                const endTime = new Date(2000, 0, 1, employee.workingHours.end, 0);
                
                if (selectedDateTime >= startTime && selectedDateTime < endTime) {
                    const button = document.createElement('button');
                    button.className = 'employee-button';
                    button.textContent = employee.name;
                    button.onclick = () => selectEmployee(button, employee.name);
                    container.appendChild(button);
                }
            });
        }

        function selectEmployee(button, name) {
            document.querySelectorAll('.employee-button').forEach(b => b.classList.remove('selected'));
            button.classList.add('selected');
            document.getElementById('selected-employee').value = name;
        }

        document.getElementById('booking-date').addEventListener('change', function(e) {
            document.getElementById('selected-date').value = e.target.value;
        });

        // Initialize the booking system
        generateTimeSlots();

        // Modify the existing submit event listener
        document.getElementById('bookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const date = document.getElementById('selected-date').value;
            const time = document.getElementById('selected-time').value;
            const employee = document.getElementById('selected-employee').value;
            
            const message = `New Booking:
Name: ${name}
Phone: ${phone}
Date: ${date}
Time: ${time}
Employee: ${employee}
Selected Services: ${selectedServices.map(s => s.name).join(', ')}
Total Price: ${totalPrice} SAR`;
            
            const whatsappLink = "https://wa.me/966599791440?text=" + encodeURIComponent(message);
            
            window.open(whatsappLink, '_blank');
        });
    </script>
</body>
</html>
